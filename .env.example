# =============================================================================
# Indexer Go v2 - Environment Configuration (EXAMPLE)
# =============================================================================
# Copy this file to .env and fill in your actual values

# =============================================================================
# EXISTING INFRASTRUCTURE CONNECTIONS
# =============================================================================

# PostgreSQL Database (shared with backend - same database, indexer uses separate schema)
# The indexer connects to the same database as the backend to access Invoice, Wallet, Currency tables
# Indexer-specific tables (cursors, processed_blocks) are in the 'indexer' schema
DATABASE_URL=postgresql://ammar.robb:password@localhost:5432/appreal?sslmode=disable

# Schema Configuration
# Backend schema: where Invoice, Wallet, Currency, Network tables live
# - Local development: public
# - Dev environment: appreal_dev
# - Production: your_prod_schema
BACKEND_SCHEMA=public

# Indexer schema: where IndexerCursor, ProcessedBlock, IndexerStats tables live
# Usually stays as 'indexer' across all environments
INDEXER_SCHEMA=indexer

# Connection Pool Configuration
CONFIG_POOL_MAX_CONNS=5
CONFIG_POOL_MIN_CONNS=2
INDEXER_POOL_MAX_CONNS=10
INDEXER_POOL_MIN_CONNS=3

# Redis Configuration
REDIS_SENTINEL=true
REDIS_SENTINEL_URL=redis+sentinel://username:password@host1:26379,host2:26380,host3:26381/mastername
REDIS_URL=redis://:password@localhost:6381/3
REDIS_PASSWORD=your_redis_password
REDIS_DB=3

# =============================================================================
# RPC CONFIGURATION
# =============================================================================

# ERPC Configuration (replace with your actual API key)
ERPC_API_KEY=your_ercp_api_key_here

# Chain-specific RPC endpoints
ETHEREUM_RPC_URL=http://your-erpc-host:4000/main/evm/1
POLYGON_RPC_URL=http://your-erpc-host:4000/main/evm/137
ARBITRUM_RPC_URL=http://your-erpc-host:4000/main/evm/42161
BSC_RPC_URL=http://your-erpc-host:4000/main/evm/56

# Public RPC fallbacks (uncomment to use)
# ETHEREUM_RPC_URL=https://mainnet.infura.io/v3/YOUR_PROJECT_ID
# POLYGON_RPC_URL=https://polygon-rpc.com
# ARBITRUM_RPC_URL=https://arb1.arbitrum.io/rpc
# BSC_RPC_URL=https://bsc-dataseed1.binance.org

# =============================================================================
# RPC TIMEOUT CONFIGURATION
# =============================================================================

RPC_HTTP_TIMEOUT=120s
RPC_DIAL_TIMEOUT=30s
RPC_HEADER_TIMEOUT=90s

# =============================================================================
# WEBHOOK CONFIGURATION
# =============================================================================

# Backend webhook endpoint
WEBHOOK_URL=http://localhost:8001/api/v1/webhook/indexer

# Authentication for webhook (generate secure random values)
INDEXER_API_KEY=your_secure_api_key_here
INDEXER_WEBHOOK_SECRET=your_secure_webhook_secret_here

# Webhook behavior
WEBHOOK_RETRIES=3
WEBHOOK_RETRY_DELAY=5s
WEBHOOK_TIMEOUT=30s

# =============================================================================
# WORKER CONFIGURATION
# =============================================================================

# Forward worker timing
FORWARD_INTERVAL=5s
FORWARD_BLOCK_RANGE=10

# Backfill worker timing
BACKFILL_INTERVAL=15s
BACKFILL_WINDOW_SIZE=5000

# Confirmation worker timing
CONFIRMATION_INTERVAL=30s

# =============================================================================
# LOGGING CONFIGURATION
# =============================================================================

LOG_LEVEL=info
LOG_FORMAT=json

# =============================================================================
# PERFORMANCE CONFIGURATION
# =============================================================================

RPC_BATCH_SIZE=100
MAX_PARALLEL_WORKERS=5
REDIS_POOL_SIZE=10
REDIS_MIN_IDLE_CONNECTIONS=3

# =============================================================================
# DEVELOPMENT CONFIGURATION
# =============================================================================

DEBUG=false
METRICS_ENABLED=true
METRICS_PORT=9090
HEALTH_CHECK_PORT=8080

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_SECOND=100
REQUEST_TIMEOUT=30s
DIAL_TIMEOUT=10s

# =============================================================================
# MONITORING CONFIGURATION
# =============================================================================

PROMETHEUS_ENABLED=true
PROMETHEUS_PORT=9090
HEALTH_CHECK_INTERVAL=30s
RPC_HEALTH_CHECK_INTERVAL=60s
WEBHOOK_HEALTH_CHECK_INTERVAL=120s